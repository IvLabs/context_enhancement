
train_translation.py --load=0
Reusing dataset opus_rf (/home/ivlabs/.cache/huggingface/datasets/opus_rf/de-en/1.0.0/3725eb23f8df679ddd37d8d65a6bbfcda7732c66edccbc62a3c3b1354c934c9f)
Some weights of the model checkpoint at bert-base-multilingual-uncased were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight', 'cls.predictions.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
{"epoch": 0, "step": 0, "loss": 7.128603458404541, "time": 5}
{"epoch": 0, "step": 5, "loss": 156.04449462890625, "time": 5}
/home/ivlabs/context_enhancement/context_new/new/context_enhancement/train_translation.py:275: UserWarning: torch.nn.utils.clip_grad_norm is now deprecated in favor of torch.nn.utils.clip_grad_norm_.
  torch.nn.utils.clip_grad_norm(model.parameters(), args.clip)
{"epoch": 0, "step": 10, "loss": 154.7353515625, "time": 6}
translation model saved in checkpoint
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10103, 13054, 10108, 37727, 10104, 10372, 11913, 10127, 11053,   119,
          102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10125, 10103, 29263, 11280, 21152, 10108, 10103, 16451, 14086,   117,
        11312, 14693, 10173, 54633, 10150, 10110, 29605, 10142, 10104, 10103,
        11134, 13896, 11523, 14650, 10346, 10103, 15152, 10139, 14299, 57616,
        14666,   131, 10103, 20202,   117, 12851, 37727, 10110, 45430,   119,
          102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([21113, 10127,   143, 12050, 11913, 10139, 24850,   119,   102],
       device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([79481, 11229, 10346, 14356, 20550, 10139, 29785, 14262, 10110, 42136,
        12090, 32837, 10104, 13214, 10982, 16993, 52378, 10320, 85197, 10285,
        71132,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10844, 10104, 10103, 22151, 13170,   117, 79481, 11229, 10346, 14356,
        20550, 10139, 10144, 28194, 23209, 10108, 10103, 22389, 10472,   119,
          102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([123, 119, 102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([124, 119, 102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([43959, 10139, 13498,   117, 11497, 10110, 13044, 19394, 10107, 14975,
        10551, 40127, 11229, 10346, 19164,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([21113,   112,   161, 12763, 16894, 10438, 31377, 47461, 10563, 10104,
        16769, 10868,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([69066, 10139, 10103, 19569, 10110, 10103, 96237, 14650, 14989, 22107,
        57616, 10104, 10367, 20532,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10103, 35040, 11312, 55257, 10104, 10103, 12878, 10916, 10868, 11229,
        19524, 10487, 11982, 10125, 57616, 10104, 10372, 11913, 10770, 10103,
        29468, 10114, 10695,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10104, 10372, 27195,   117, 10103, 35458, 10108, 12851, 37727,   117,
        45430,   117,   143, 12050, 14149, 19569, 10110, 13293, 11168, 24264,
        11229, 10346, 14758, 17156,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([  143, 33533, 10108, 10103, 73444, 18116,   118, 22389, 17593, 10104,
        10595, 10151,   124, 43689, 12819, 11229, 10346, 21509, 10104, 10103,
        10403, 11125, 10139, 12851,   118, 10573, 31176,   119,   102],
       device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10103, 11594,   112,   161, 22853, 13651, 59343, 10114, 32097, 52958,
        10203, 29263, 68350, 10107, 13208, 13594, 36616, 14094, 19382, 10125,
        10103, 19569,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([15929, 44909, 77949, 10503, 12325, 10103, 12485, 10285, 12238, 14650,
        10346, 31377,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10103, 34763, 10127, 10114, 85270, 65343, 10218, 11497, 10110, 53938,
          119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([42416, 72829, 10108, 10246, 18454, 76601, 11229, 10346, 17200,   119,
          102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([34321, 11229, 10346, 15227, 10114, 30562, 10103, 18785, 95044, 12705,
        10108, 10103, 11481, 34029,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([  125,   119, 15636, 10110, 35054, 11229, 14989, 22107, 11232,   119,
          102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10197, 11229, 10346, 78832, 10171, 22418, 14856, 10110, 21516, 19771,
          119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10668, 10348,   118, 14370, 12325, 11865, 10110, 12077, 10127, 19641,
        43131, 12652,   119,   102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([35645, 42888, 10123, 14358, 10104, 14149, 10287, 10110, 27089, 14194,
        12315, 11229, 11923, 10144, 12652, 11892, 10104, 10372, 27195,   119,
          102], device='cuda:0')
out ['s', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the', 'the']
predicted tensor([10770, 10372, 22151, 13170,   117, 33189, 10125,   143, 23676, 14463,
        10108, 10482, 28781, 10171, 11498, 11229, 10346, 41755, 22117,   119,
